---
title: 线上运筹优化公式推导
mathjax: true
toc: true
date: 2025-01-15 02:58:25
updated: 2025-01-15 02:58:25
categories:
- Marketing
tags:
- 拉格朗日
---

营销本质是个预算分配问题，即如何在有限资源约束下实现收益最大化。当用户进入营销场景时，我们需要确定**是否给该用户发放红包**以及**发放红包面额**。

<!--more-->

选择发放用户和发放面额是一个典型的分组背包问题(MCKP, Multiple Choice Knapsack Problem)，在成本约束下的的券核销率最大化。具体问题定义如下：

$$
max \sum_{i,j} x_{i,j}p_{i,j} \\

\begin{aligned}
\text { s.t. } x_{i,j} & \in \{0, 1\} \\
\sum_{j} x_{i,j} &\leq 1 \\
\sum_{i,j} x_{i,j} c_{i,j} &\leq C \\
\end{aligned}
$$
- $x_{i,j}$ 表示是否给用户$i$发放金额$j$

$$
\begin{aligned}
L(x, \lambda, u) & =-\sum_{i, j} t_{i j} x_{i j}+\sum_k \lambda_k\left(\sum_{i j} d_{i j k} x_{i j}-I_k\right)+\sum_i u_i\left(\sum_j x_{i j}-1\right) \\
& =\sum_{i j} x_{i j}\left(-t_{i j}+\sum_k \lambda_k d_{i j k}+u_i\right)-\sum_k \lambda_k I_k-\sum_i u_i \\
\text { s.t. } & \\
\lambda_k \geq 0 & \\
u_i \geq 0 & \\
x_{i j} \geq 0 &
\end{aligned}
$$

$$
\begin{aligned}
D(\lambda, u) & =\max _{\lambda, u} \min _x L(x, \lambda, u) \\
& =\max _{\lambda, u} \min _x\left(\sum_{i j} x_{i j}\left(-t_{i j}+\sum_k \lambda_k d_{i j k}+u_i\right)-\sum_k \lambda_k I_k-\sum_i u_i\right) \\
\text { s.t. } & \\
\lambda_k & \geq 0 \\
u_i & \geq 0 \\
x_{i j} & \geq 0
\end{aligned}
$$