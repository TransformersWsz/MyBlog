---
title: 线上运筹优化公式推导
mathjax: true
toc: true
date: 2025-01-15 02:58:25
updated: 2025-01-15 02:58:25
categories:
- Marketing
tags:
- 拉格朗日
---

营销本质是个预算分配问题，即如何在有限资源约束下实现收益最大化。当用户进入营销场景时，我们需要确定**是否给该用户发放红包**以及**发放红包面额**。

<!--more-->

选择发放用户和发放面额是一个典型的分组背包问题(MCKP, Multiple Choice Knapsack Problem)，在成本约束下的的券核销率最大化。

## 问题定义

$$
min -\sum_{i,j} x_{i,j}p_{i,j} \\

\begin{aligned}
\text { s.t. } x_{i,j} & \in \{0, 1\} \\
\sum_{j} x_{i,j} &= 1 \\
\sum_{i,j} x_{i,j} c_{i,j} &\leq C \\
\end{aligned}
$$
- $x_{i,j}$ 表示是否给用户$i$发放红包$j$
- $p_{i,j}$ 表示用户$i$在红包$j$下的核销率，由量价模型预估产生
- $c_{i,j}$ 表示给用户$i$发放红包$j$的成本，即红包$j$的面额
- $C$ 表示总成本

## 构造拉格朗日对偶函数

$$
\begin{aligned}
L(x, \lambda, u) & =-\sum_{i, j} x_{i,j}p_{i,j}+ \lambda\left(\sum_{i j}  x_{i j}c_{i j}-C\right) \\
& =\sum_{i j} x_{i j}\left(-p_{i j}+ \lambda c_{i,j}\right) - \lambda C \\
\text { s.t. } &\lambda \geq 0, \ u_i \geq 0, \ \sum_{j} x_{i,j} = 1
\end{aligned}
$$

$$
\begin{aligned}
D(\lambda, u) & =\max _{\lambda, u} \min _x L(x, \lambda, u) \\
& =\max _{\lambda, u} \min _x\left(\sum_{i j} x_{i j}\left(-p_{i j}+ \lambda c_{i,j}\right) - \lambda C \right) \\
\text { s.t. } &\lambda \geq 0, \ u_i \geq 0, \ \sum_{j} x_{i,j} = 1
\end{aligned}
$$

给定用户$i$，因为